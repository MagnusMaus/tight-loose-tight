<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sam - Karriere-Coach</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
        #root {
            width: 100%;
            height: 100vh;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;
        const { createRoot } = ReactDOM;

        // Lucide icons as inline SVGs
        const SendIcon = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="22" y1="2" x2="11" y2="13"></line>
                <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
            </svg>
        );

        const FileUpIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="12" y1="18" x2="12" y2="12"></line>
                <line x1="9" y1="15" x2="15" y2="15"></line>
            </svg>
        );

        const CheckCircleIcon = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
        );

        const BookmarkPlusIcon = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m19 21-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                <line x1="12" y1="7" x2="12" y2="13"></line>
                <line x1="9" y1="10" x2="15" y2="10"></line>
            </svg>
        );

        const Trash2Icon = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );

        const SearchIcon = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
        );

        const SamCareerCoach = () => {
            const [messages, setMessages] = useState([]);
            const [input, setInput] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [jobCards, setJobCards] = useState([]);
            const [isSearchingJobs, setIsSearchingJobs] = useState(false);
            const messagesEndRef = useRef(null);
            const fileInputRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages, jobCards]);

            useEffect(() => {
                const greeting = getGreeting();
                setMessages([{
                    role: 'assistant',
                    content: greeting
                }]);
            }, []);

            const getGreeting = () => {
                const hour = new Date().getHours();
                let timeOfDay;
                if (hour < 12) timeOfDay = 'Morgen';
                else if (hour < 18) timeOfDay = 'Mittag';
                else timeOfDay = 'Abend';

                return `Guten ${timeOfDay}, schön, dass du da bist. Mein Name ist Sam. Ich bin hier, um dich dabei zu unterstützen, deinen nächsten Karriereschritt zu finden.

Damit dieser Schritt genau zu dir passt, stelle ich dir gleich ein paar Fragen. Je offener und präziser du sie beantwortest, desto besser wird das Ergebnis. Keine Sorge! Deine Daten sind bei mir sicher. Sie sind von niemandem sonst einsehbar.

In welcher beruflichen Situation befindest du dich gerade?`;
            };

            const getSystemPrompt = () => {
                return `Du bist Sam, ein fortschrittlicher Karriere-Coach, der Menschen dabei unterstützt, ihren idealen beruflichen nächsten Schritt zu finden.

WICHTIG: Du hast Zugriff auf echte Job-Daten von JSearch. Wenn du das Profil des Nutzers vollständig erfasst hast, sage ihm dass du jetzt passende Jobs suchen kannst.

WENN DU EINEN JOB EMPFEHLEN MÖCHTEST, formatiere ihn EXAKT so am Ende deiner Nachricht:

[JOB_CARD:{
  "title": "Job Titel",
  "company": "Firmenname", 
  "location": "Ort",
  "salary": "Gehalt falls verfügbar",
  "description": "Kurze prägnante Zusammenfassung in 2-3 Sätzen",
  "fitScore": 85,
  "pros": ["Grund 1 warum es passt", "Grund 2 warum es passt"],
  "cons": ["Aspekt der beachtet werden sollte"],
  "applyUrl": "https://..."
}]

WENN DU READY BIST FÜR DIE JOB-SUCHE, schreibe am Ende deiner Nachricht:
[TRIGGER_SEARCH:{
  "query": "Projektmanager Software",
  "location": "Berlin"
}]

Das System wird dann automatisch JSearch aufrufen und dir echte Jobs liefern, die du analysieren kannst.

GESPRÄCHSFÜHRUNG:
- Sei ein hilfreicher Sparringspartner und Coach, besonders bei Unsicherheiten
- Stelle NUR EINE Frage pro Nachricht und platziere sie IMMER am Ende
- Gib bei Fragen sinnvolle Antwortmöglichkeiten als Beispiele zur kognitiven Unterstützung
- Nutze Emojis angemessen um menschlicher zu wirken und Vertrauen aufzubauen
- Frage gezielt nach um ein vollständiges Bild zu erhalten, bevor du zur nächsten Hauptfrage übergehst

PROFILERSTELLUNG:
Erstelle ein mehrdimensionales Profil basierend auf:

1. WERTE & MOTIVATOREN:
   - Autonomie vs. Struktur: Braucht Freiraum oder klare Vorgaben?
   - Innovation vs. Stabilität: Risikobereitschaft bei Veränderungen?
   - Impact vs. Sicherheit: Gestaltungswille vs. Absicherungsbedürfnis?
   - Kollaboration vs. Expertise: Team-Player oder Fachexperte?
   - Wachstum vs. Balance: Karriereambition vs. Work-Life-Balance?

2. ARBEITSPSYCHOLOGIE:
   - Entscheidungsstil: Analytisch, intuitiv, konsensbasiert?
   - Stressresilienz: Wie mit Druck/Deadlines umgehen?
   - Kommunikationspräferenz: Direkt, diplomatisch, präsentationsstark?
   - Lerntyp: Hands-on, theoretisch, mentorbasiert?
   - Führungsstil: Servant Leader, visionär, operativ?

3. UMFELD-PRÄFERENZEN:
   - Unternehmenskultur: Startup-Chaos, Corporate-Struktur, Familienunternehmen?
   - Team-Dynamik: Kleine Teams, große Projekte, internationale Matrix?
   - Branche: Traditionell, Tech, Purpose-driven?
   - Arbeitsmodell: Remote, Office, hybrid, reiseintensiv

Lies dabei auch empathisch und systemisch zwischen den Zeilen.

DIE DREI HAUPTFRAGEN (nacheinander stellen):
1. "In welcher beruflichen Situation befindest du dich gerade?"
2. "Wo möchtest du dich beruflich hinentwickeln? Falls dir die Frage schwerfällt: Was möchtest du in 3 bis 5 Jahren beruflich tun oder erreicht haben?"
3. "Welche (besonderen ✨) Fähigkeiten besitzt du? Gehe dabei gern auf deine gesammelten Erfahrungen ein. Wenn du möchtest, dann kannst du gerne dein CV hochladen, um es dir einfach zu machen. 😊📄"

FIT-SCORE BERECHNUNG:
GESAMT-FIT-SCORE = (Fachlich × 0.3) + (Psychografisch × 0.5) + (Umfeld × 0.2)

- Fachlicher Fit (30%): Skills-Match, Erfahrungslevel, Lernkurve
- Psychografischer Fit (50%): Werte-Alignment, Arbeitstyp-Match, Stress-Faktoren
- Umfeld-Fit (20%): Unternehmenskultur, Team-Struktur, Branche

Halte den Nutzer im Loop über deine Schlussfolgerungen, bleib dabei aber an der Oberfläche, um den Nutzer nicht zu überfordern. Maximal ein Satz.

Gib eine grobe Einschätzung ab, wie viele Fragen noch im jeweiligen Abschnitt folgen werden, damit du ein möglichst gutes Profil erstellen kannst.

JOBEMPFEHLUNGEN:
- Zeige IMMER nur EINEN Job pro Nachricht
- Fasse jeden Job sinnvoll zusammen - der Nutzer muss nicht auf den Link klicken müssen
- Hebe hervor, was zum Nutzer passt und was nicht
- Nach jedem Job-Vorschlag: warte auf Nutzer-Feedback bevor du den nächsten zeigst
- Bei Ablehnung: Frage nach der Begründung um das Profil zu verfeinern`;
            };

            const searchJobs = async (query, location) => {
                setIsSearchingJobs(true);
                try {
                    const response = await fetch('/.netlify/functions/search-jobs', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            query: query,
                            location: location,
                            country: 'de'
                        })
                    });

                    const data = await response.json();
                    
                    // Gib Sam die Job-Daten zur Analyse (JSearch Format)
                    const jobsContext = `Hier sind ${data.data?.length || 0} echte Jobs von JSearch für "${query}" in "${location}":

${data.data?.slice(0, 5).map((job, i) => `
Job ${i + 1}:
- Titel: ${job.job_title}
- Firma: ${job.employer_name || 'Unbekannt'}
- Ort: ${job.job_city || job.job_country || location}
- Gehalt: ${job.job_min_salary && job.job_max_salary ? `€${job.job_min_salary.toLocaleString()} - €${job.job_max_salary.toLocaleString()}` : job.job_salary_currency && job.job_salary_period ? `${job.job_salary_currency} ${job.job_salary_period}` : 'Nicht angegeben'}
- Beschreibung: ${job.job_description?.substring(0, 300)}...
- URL: ${job.job_apply_link}
`).join('\n')}

Analysiere diese Jobs basierend auf dem Profil des Nutzers. Wähle den BESTEN Match aus, berechne einen Fit-Score und erstelle eine JOB_CARD mit Pros/Cons.`;

                    // Sende die Jobs an Sam zur Analyse
                    const updatedMessages = [...messages, {
                        role: 'user',
                        content: 'Ich möchte die Jobs sehen!'
                    }, {
                        role: 'user',
                        content: jobsContext
                    }];

                    const samResponse = await fetch('/.netlify/functions/chat', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            messages: updatedMessages,
                            system: getSystemPrompt()
                        })
                    });

                    const samData = await samResponse.json();
                    const assistantMessage = samData.content[0].text;

                    // Parse Job-Card
                    const jobMatch = assistantMessage.match(/\[JOB_CARD:(.+?)\]/s);
                    if (jobMatch) {
                        try {
                            const jobData = JSON.parse(jobMatch[1]);
                            setJobCards(prev => [...prev, { ...jobData, id: Date.now() }]);
                            const cleanMessage = assistantMessage.replace(/\[JOB_CARD:.+?\]/s, '').trim();
                            setMessages([...messages, { role: 'assistant', content: cleanMessage }]);
                        } catch (e) {
                            console.error('Error parsing job card:', e);
                            setMessages([...messages, { role: 'assistant', content: assistantMessage }]);
                        }
                    } else {
                        setMessages([...messages, { role: 'assistant', content: assistantMessage }]);
                    }

                } catch (error) {
                    console.error('Job search error:', error);
                    setMessages([...messages, {
                        role: 'assistant',
                        content: 'Es gab leider ein Problem bei der Job-Suche. Lass uns es nochmal versuchen! 🔧'
                    }]);
                } finally {
                    setIsSearchingJobs(false);
                }
            };

            const handleSend = async () => {
                if (!input.trim() || isLoading) return;

                const userMessage = { role: 'user', content: input };
                const updatedMessages = [...messages, userMessage];
                setMessages(updatedMessages);
                setInput('');
                setIsLoading(true);

                try {
                    const response = await fetch('/.netlify/functions/chat', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            messages: updatedMessages,
                            system: getSystemPrompt()
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const data = await response.json();
                    const assistantMessage = data.content[0].text;

                    // Check for search trigger
                    const searchTrigger = assistantMessage.match(/\[TRIGGER_SEARCH:(.+?)\]/s);
                    if (searchTrigger) {
                        try {
                            const searchParams = JSON.parse(searchTrigger[1]);
                            const cleanMessage = assistantMessage.replace(/\[TRIGGER_SEARCH:.+?\]/s, '').trim();
                            setMessages([...updatedMessages, { role: 'assistant', content: cleanMessage }]);
                            
                            // Trigger automatic search
                            await searchJobs(searchParams.query, searchParams.location);
                            return;
                        } catch (e) {
                            console.error('Error parsing search trigger:', e);
                        }
                    }

                    // Check for job card
                    const jobMatch = assistantMessage.match(/\[JOB_CARD:(.+?)\]/s);
                    if (jobMatch) {
                        try {
                            const jobData = JSON.parse(jobMatch[1]);
                            setJobCards(prev => [...prev, { ...jobData, id: Date.now() }]);
                            
                            const cleanMessage = assistantMessage.replace(/\[JOB_CARD:.+?\]/s, '').trim();
                            setMessages([...updatedMessages, { role: 'assistant', content: cleanMessage }]);
                        } catch (e) {
                            console.error('Error parsing job card:', e);
                            setMessages([...updatedMessages, { role: 'assistant', content: assistantMessage }]);
                        }
                    } else {
                        setMessages([...updatedMessages, { role: 'assistant', content: assistantMessage }]);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    setMessages([...updatedMessages, { 
                        role: 'assistant', 
                        content: 'Entschuldigung, es gab einen technischen Fehler. Bitte versuche es nochmal. 🔧' 
                    }]);
                } finally {
                    setIsLoading(false);
                }
            };

            const handleFileUpload = async (event) => {
                const file = event.target.files?.[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = async (e) => {
                    const content = e.target.result;
                    const fileMessage = `[CV hochgeladen: ${file.name}]\n\n${content.substring(0, 5000)}`;
                    setInput(fileMessage);
                };
                reader.readAsText(file);
            };

            const handleJobAction = async (jobId, action) => {
                const job = jobCards.find(j => j.id === jobId);
                if (!job) return;

                let userResponse = '';
                if (action === 'apply') {
                    userResponse = `Ich möchte mich für die Position "${job.title}" bewerben. Wie gehe ich am besten vor?`;
                    if (job.applyUrl) {
                        window.open(job.applyUrl, '_blank');
                    }
                } else if (action === 'save') {
                    userResponse = `Ich möchte die Position "${job.title}" erstmal speichern. Zeige mir weitere passende Stellen.`;
                } else if (action === 'reject') {
                    userResponse = `Die Position "${job.title}" passt nicht zu mir.`;
                }

                setJobCards(prev => prev.filter(j => j.id !== jobId));

                const userMessage = { role: 'user', content: userResponse };
                const updatedMessages = [...messages, userMessage];
                setMessages(updatedMessages);
                setIsLoading(true);

                try {
                    const response = await fetch('/.netlify/functions/chat', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            messages: updatedMessages,
                            system: getSystemPrompt()
                        })
                    });

                    const data = await response.json();
                    const assistantMessage = data.content[0].text;
                    
                    const jobMatch = assistantMessage.match(/\[JOB_CARD:(.+?)\]/s);
                    if (jobMatch) {
                        try {
                            const jobData = JSON.parse(jobMatch[1]);
                            setJobCards(prev => [...prev, { ...jobData, id: Date.now() }]);
                            const cleanMessage = assistantMessage.replace(/\[JOB_CARD:.+?\]/s, '').trim();
                            setMessages([...updatedMessages, { role: 'assistant', content: cleanMessage }]);
                        } catch (e) {
                            setMessages([...updatedMessages, { role: 'assistant', content: assistantMessage }]);
                        }
                    } else {
                        setMessages([...updatedMessages, { role: 'assistant', content: assistantMessage }]);
                    }
                } catch (error) {
                    console.error('Error:', error);
                } finally {
                    setIsLoading(false);
                }
            };

            return (
                <div style={{
                    maxWidth: '900px',
                    margin: '0 auto',
                    height: '100vh',
                    display: 'flex',
                    flexDirection: 'column',
                    backgroundColor: '#f8f9fa'
                }}>
                    <div style={{
                        backgroundColor: '#2563eb',
                        color: 'white',
                        padding: '20px',
                        textAlign: 'center',
                        boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
                    }}>
                        <h1 style={{ margin: 0, fontSize: '24px', fontWeight: '600' }}>
                            💼 Sam - Dein Karriere-Coach
                        </h1>
                        <p style={{ margin: '5px 0 0 0', fontSize: '14px', opacity: 0.9 }}>
                            Finde deinen perfekten nächsten Karriereschritt
                        </p>
                    </div>

                    <div style={{
                        flex: 1,
                        overflowY: 'auto',
                        padding: '20px',
                        display: 'flex',
                        flexDirection: 'column',
                        gap: '16px'
                    }}>
                        {messages.map((message, index) => (
                            <div
                                key={index}
                                style={{
                                    display: 'flex',
                                    justifyContent: message.role === 'user' ? 'flex-end' : 'flex-start'
                                }}
                            >
                                <div style={{
                                    maxWidth: '70%',
                                    padding: '12px 16px',
                                    borderRadius: '12px',
                                    backgroundColor: message.role === 'user' ? '#2563eb' : 'white',
                                    color: message.role === 'user' ? 'white' : '#1f2937',
                                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                    whiteSpace: 'pre-wrap',
                                    lineHeight: '1.5'
                                }}>
                                    {message.content}
                                </div>
                            </div>
                        ))}

                        {jobCards.map((job) => (
                            <div key={job.id} style={{
                                backgroundColor: 'white',
                                borderRadius: '16px',
                                padding: '24px',
                                boxShadow: '0 4px 6px rgba(0,0,0,0.1)',
                                border: '2px solid #e5e7eb',
                                maxWidth: '85%',
                                margin: '0 auto',
                                width: '100%'
                            }}>
                                <div style={{
                                    display: 'inline-block',
                                    backgroundColor: job.fitScore >= 80 ? '#10b981' : job.fitScore >= 60 ? '#f59e0b' : '#ef4444',
                                    color: 'white',
                                    padding: '4px 12px',
                                    borderRadius: '20px',
                                    fontSize: '14px',
                                    fontWeight: '600',
                                    marginBottom: '12px'
                                }}>
                                    {job.fitScore}% Match
                                </div>

                                <h3 style={{ 
                                    margin: '0 0 8px 0', 
                                    fontSize: '20px', 
                                    fontWeight: '600',
                                    color: '#1f2937'
                                }}>
                                    {job.title}
                                </h3>

                                <div style={{ 
                                    display: 'flex', 
                                    gap: '16px', 
                                    fontSize: '14px', 
                                    color: '#6b7280',
                                    marginBottom: '16px',
                                    flexWrap: 'wrap'
                                }}>
                                    <span>🏢 {job.company}</span>
                                    <span>📍 {job.location}</span>
                                    {job.salary && <span>💰 {job.salary}</span>}
                                </div>

                                <p style={{ 
                                    fontSize: '15px', 
                                    lineHeight: '1.6', 
                                    color: '#374151',
                                    marginBottom: '16px'
                                }}>
                                    {job.description}
                                </p>

                                {job.pros && job.pros.length > 0 && (
                                    <div style={{ marginBottom: '12px' }}>
                                        <div style={{ 
                                            fontSize: '14px', 
                                            fontWeight: '600', 
                                            color: '#10b981',
                                            marginBottom: '6px'
                                        }}>
                                            ✅ Was passt:
                                        </div>
                                        <ul style={{ 
                                            margin: 0, 
                                            paddingLeft: '20px',
                                            fontSize: '14px',
                                            color: '#374151'
                                        }}>
                                            {job.pros.map((pro, i) => (
                                                <li key={i} style={{ marginBottom: '4px' }}>{pro}</li>
                                            ))}
                                        </ul>
                                    </div>
                                )}

                                {job.cons && job.cons.length > 0 && (
                                    <div style={{ marginBottom: '20px' }}>
                                        <div style={{ 
                                            fontSize: '14px', 
                                            fontWeight: '600', 
                                            color: '#f59e0b',
                                            marginBottom: '6px'
                                        }}>
                                            ⚠️ Beachte:
                                        </div>
                                        <ul style={{ 
                                            margin: 0, 
                                            paddingLeft: '20px',
                                            fontSize: '14px',
                                            color: '#374151'
                                        }}>
                                            {job.cons.map((con, i) => (
                                                <li key={i} style={{ marginBottom: '4px' }}>{con}</li>
                                            ))}
                                        </ul>
                                    </div>
                                )}

                                <div style={{ 
                                    display: 'flex', 
                                    gap: '12px',
                                    marginTop: '20px',
                                    flexWrap: 'wrap'
                                }}>
                                    <button
                                        onClick={() => handleJobAction(job.id, 'apply')}
                                        style={{
                                            flex: '1',
                                            minWidth: '140px',
                                            padding: '12px 20px',
                                            backgroundColor: '#2563eb',
                                            color: 'white',
                                            border: 'none',
                                            borderRadius: '8px',
                                            fontSize: '15px',
                                            fontWeight: '600',
                                            cursor: 'pointer',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            gap: '8px'
                                        }}
                                    >
                                        <CheckCircleIcon />
                                        Bewerben
                                    </button>
                                    
                                    <button
                                        onClick={() => handleJobAction(job.id, 'save')}
                                        style={{
                                            flex: '1',
                                            minWidth: '140px',
                                            padding: '12px 20px',
                                            backgroundColor: '#10b981',
                                            color: 'white',
                                            border: 'none',
                                            borderRadius: '8px',
                                            fontSize: '15px',
                                            fontWeight: '600',
                                            cursor: 'pointer',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            gap: '8px'
                                        }}
                                    >
                                        <BookmarkPlusIcon />
                                        Speichern
                                    </button>
                                    
                                    <button
                                        onClick={() => handleJobAction(job.id, 'reject')}
                                        style={{
                                            flex: '1',
                                            minWidth: '140px',
                                            padding: '12px 20px',
                                            backgroundColor: '#ef4444',
                                            color: 'white',
                                            border: 'none',
                                            borderRadius: '8px',
                                            fontSize: '15px',
                                            fontWeight: '600',
                                            cursor: 'pointer',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            gap: '8px'
                                        }}
                                    >
                                        <Trash2Icon />
                                        Verwerfen
                                    </button>
                                </div>
                            </div>
                        ))}

                        {(isLoading || isSearchingJobs) && (
                            <div style={{ display: 'flex', justifyContent: 'flex-start' }}>
                                <div style={{
                                    padding: '12px 16px',
                                    borderRadius: '12px',
                                    backgroundColor: 'white',
                                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)',
                                    display: 'flex',
                                    gap: '8px',
                                    alignItems: 'center'
                                }}>
                                    {isSearchingJobs ? (
                                        <>
                                            <SearchIcon />
                                            <span style={{ fontSize: '14px', color: '#6b7280' }}>
                                                Suche passende Jobs...
                                            </span>
                                        </>
                                    ) : (
                                        <>
                                            <div className="bounce-dot" style={{ animationDelay: '0s' }} />
                                            <div className="bounce-dot" style={{ animationDelay: '0.16s' }} />
                                            <div className="bounce-dot" style={{ animationDelay: '0.32s' }} />
                                        </>
                                    )}
                                </div>
                            </div>
                        )}

                        <div ref={messagesEndRef} />
                    </div>

                    <div style={{
                        padding: '20px',
                        backgroundColor: 'white',
                        borderTop: '1px solid #e5e7eb',
                        boxShadow: '0 -2px 4px rgba(0,0,0,0.05)'
                    }}>
                        <div style={{ display: 'flex', gap: '12px', alignItems: 'flex-end' }}>
                            <input
                                type="file"
                                ref={fileInputRef}
                                onChange={handleFileUpload}
                                accept=".txt,.pdf,.doc,.docx"
                                style={{ display: 'none' }}
                            />
                            
                            <button
                                onClick={() => fileInputRef.current?.click()}
                                disabled={isLoading || isSearchingJobs}
                                style={{
                                    padding: '12px',
                                    backgroundColor: '#f3f4f6',
                                    border: '1px solid #d1d5db',
                                    borderRadius: '8px',
                                    cursor: (isLoading || isSearchingJobs) ? 'not-allowed' : 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center'
                                }}
                            >
                                <FileUpIcon />
                            </button>

                            <textarea
                                value={input}
                                onChange={(e) => setInput(e.target.value)}
                                onKeyPress={(e) => {
                                    if (e.key === 'Enter' && !e.shiftKey) {
                                        e.preventDefault();
                                        handleSend();
                                    }
                                }}
                                placeholder="Schreibe deine Antwort..."
                                disabled={isLoading || isSearchingJobs}
                                style={{
                                    flex: 1,
                                    padding: '12px 16px',
                                    borderRadius: '8px',
                                    border: '1px solid #d1d5db',
                                    fontSize: '15px',
                                    resize: 'none',
                                    minHeight: '48px',
                                    maxHeight: '120px',
                                    fontFamily: 'inherit',
                                    outline: 'none'
                                }}
                                rows={1}
                            />

                            <button
                                onClick={handleSend}
                                disabled={!input.trim() || isLoading || isSearchingJobs}
                                style={{
                                    padding: '12px 24px',
                                    backgroundColor: (input.trim() && !isLoading && !isSearchingJobs) ? '#2563eb' : '#d1d5db',
                                    color: 'white',
                                    border: 'none',
                                    borderRadius: '8px',
                                    fontSize: '15px',
                                    fontWeight: '600',
                                    cursor: (input.trim() && !isLoading && !isSearchingJobs) ? 'pointer' : 'not-allowed',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px'
                                }}
                            >
                                <SendIcon />
                                Senden
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<SamCareerCoach />);
    </script>

    <style>
        .bounce-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #2563eb;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        @keyframes bounce {
            0%, 80%, 100% { 
                transform: scale(0);
            }
            40% { 
                transform: scale(1);
            }
        }
    </style>
</body>
</html>
